
const fs = require('fs');
const path = require('path');

const galleryDir = './gallery';
const manifest = [];

fs.readdirSync(galleryDir, { withFileTypes: true })
  .filter(dirent => dirent.isDirectory())
  .forEach(dir => {
    const folderPath = path.join(galleryDir, dir.name);
    const files = fs.readdirSync(folderPath)
      .filter(file => /\.(jpe?g|png|gif)$/i.test(file));

    if (files.length > 0) {
      // Convert folder name to title: "2025-davao-workshop" → "2025 Davao Workshop"
      const title = dir.name
        .replace(/-/g, ' ')
        .replace(/\b\w/g, l => l.toUpperCase());

      manifest.push({
        folder: dir.name,
        title: title,
        images: files
      });
    }
  });

fs.writeFileSync(
  path.join(galleryDir, 'gallery-manifest.json'),
  JSON.stringify(manifest, null, 2)
);
console.log('✅ gallery-manifest.json generated!');